<!-- gomarkdoc:embed:start -->

<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# sbargp

```go
import "github.com/barbell-math/smoothbrain-argparse"
```

A very simple CMD line argument parser that allows for arguments to be specified from both the CLI and a TOML config file.

<details><summary>Example (Simple)</summary>
<p>



```go
package main

import (
	"flag"
	"fmt"
	"reflect"
)

type exampleConf struct {
	StoreName    string
	NumItems     int
	NumLocations int
	HasFreeFood  bool
	Department   struct {
		Name      string
		Specialty string
	}
	Vegies []string
	Fruits map[string]struct {
		Yummy bool
		Color string
	}
}

func main() {
	var c exampleConf
	err := Parse(
		&c,
		[]string{
			// Normally these would be os.Args[1:] but for the example we
			// provide a list of strings.
			"-StoreName", "kings",
			"-NumLocations", "3",
			"-conf", "./bs/example.toml",
		},
		ParserOpts[exampleConf]{
			ProgName:     "example",
			RequiredArgs: []string{"StoreName"},
			ArgDefsSetter: func(conf *exampleConf, fs *flag.FlagSet) error {
				// It is generally recommented (though not enforced) to name
				// CMD line arguments the same as the keys in the TOML file.
				fs.StringVar(&c.StoreName, "StoreName", "", "a string")
				fs.IntVar(&c.NumItems, "NumItems", 1, "a int")
				fs.IntVar(&c.NumItems, "NumLocations", 0, "a int")

				// Defaults for non-FlagSet arguments can be set here as well
				c.HasFreeFood = true // :)
				return nil
			},
		},
	)

	fmt.Println("Parsing error: ", err)

	fmt.Println("Parsed conf:")
	typ, val := reflect.TypeOf(c), reflect.ValueOf(c)
	for i := 0; i < typ.NumField(); i++ {
		fmt.Printf("  %-20s → %v\n", typ.Field(i).Name, val.Field(i).Interface())
	}

}
```

#### Output

```
Parsing error:  <nil>
Parsed conf:
  StoreName            → kings
  NumItems             → 3
  NumLocations         → 0
  HasFreeFood          → true
  Department           → {produce fruit and vegetables}
  Vegies               → [potato carrot chicken]
  Fruits               → map[apple:{true red} banana:{true yellow} orange:{true orange}]
```

</p>
</details>

## Index

- [Variables](<#variables>)
- [func Parse\[T any\]\(conf \*T, cliArgs \[\]string, opts ParserOpts\[T\]\) error](<#Parse>)
- [type AbsDir](<#AbsDir>)
  - [func \(a \*AbsDir\) UnmarshalText\(data \[\]byte\) error](<#AbsDir.UnmarshalText>)
- [type AbsFile](<#AbsFile>)
  - [func \(a \*AbsFile\) UnmarshalText\(data \[\]byte\) error](<#AbsFile.UnmarshalText>)
- [type Dir](<#Dir>)
  - [func \(d \*Dir\) UnmarshalText\(data \[\]byte\) error](<#Dir.UnmarshalText>)
- [type EnvVar](<#EnvVar>)
  - [func \(e \*EnvVar\) UnmarshalText\(data \[\]byte\) error](<#EnvVar.UnmarshalText>)
- [type File](<#File>)
  - [func \(f \*File\) UnmarshalText\(data \[\]byte\) error](<#File.UnmarshalText>)
- [type ParserOpts](<#ParserOpts>)


## Variables

<a name="InvalidArgumentErr"></a>

```go
var (
    InvalidArgumentErr         = errors.New("Invalid argument")
    InvalidConfFileErr         = errors.New("Invalid conf file")
    MissingRequiredArgsErr     = errors.New("Missing required args")
    InvalidValuesInConfFileErr = errors.New("Invalid values in conf file")
)
```

<a name="EnvVarNotSetErr"></a>

```go
var (
    EnvVarNotSetErr = errors.New(
        "The supplied environment variable was not set",
    )
)
```

<a name="MissingLeadingZeros"></a>

```go
var (
    MissingLeadingZeros = errors.New(
        "Leading zeros in date-time values cannot be left off",
    )
)
```

<a name="Parse"></a>
## func [Parse](<https://github.com/barbell-math/smoothbrain-argparse/blob/main/argparse.go#L64-L68>)

```go
func Parse[T any](conf *T, cliArgs []string, opts ParserOpts[T]) error
```

Takes a sequence of CMD line arguments and parses them. The supplied \`conf\` value will be populated with any values.

A \`conf\` argument will be added that will accept a path to a TOML config file. This TOML config file will be treated as another source of arguments, and the \`conf\` value will be populated with the contents of that file. The [burnt sushi](<https://github.com/BurntSushi/toml>) TOML parser is used internally, refer to it's documentation for things like struct field tags.

The arguments that are present in the TOML config file will take precedence over all CMD line arguments.

<a name="AbsDir"></a>
## type [AbsDir](<https://github.com/barbell-math/smoothbrain-argparse/blob/main/unmarshalers.go#L21>)

Can be used to represent an absolute path to a dir in a config. When unmarshaling the path will be made absolute if it is not already.

```go
type AbsDir string
```

<a name="AbsDir.UnmarshalText"></a>
### func \(\*AbsDir\) [UnmarshalText](<https://github.com/barbell-math/smoothbrain-argparse/blob/main/unmarshalers.go#L65>)

```go
func (a *AbsDir) UnmarshalText(data []byte) error
```

Checks that the supplied data is a valid path to a dir and if so resolves the absolute path and sets the underlying value absolute to the path.

<a name="AbsFile"></a>
## type [AbsFile](<https://github.com/barbell-math/smoothbrain-argparse/blob/main/unmarshalers.go#L16>)

Can be used to represent an absolute path to a file in a config. When unmarshaling the path will be made absolute if it is not already.

```go
type AbsFile string
```

<a name="AbsFile.UnmarshalText"></a>
### func \(\*AbsFile\) [UnmarshalText](<https://github.com/barbell-math/smoothbrain-argparse/blob/main/unmarshalers.go#L97>)

```go
func (a *AbsFile) UnmarshalText(data []byte) error
```

Checks that the supplied data is a valid path to a file and if so resolves the absolute path and sets the underlying value absolute to the path.

<a name="Dir"></a>
## type [Dir](<https://github.com/barbell-math/smoothbrain-argparse/blob/main/unmarshalers.go#L18>)

Can be used to represent a path to a dir in a config

```go
type Dir string
```

<a name="Dir.UnmarshalText"></a>
### func \(\*Dir\) [UnmarshalText](<https://github.com/barbell-math/smoothbrain-argparse/blob/main/unmarshalers.go#L51>)

```go
func (d *Dir) UnmarshalText(data []byte) error
```

Checks that the supplied data is a valid path to a dir and if so sets the underlying value to the path.

<a name="EnvVar"></a>
## type [EnvVar](<https://github.com/barbell-math/smoothbrain-argparse/blob/main/unmarshalers.go#L25>)

Can be used to represent a path to an environment variable in a config. The value of the config entry will be set to the value of the environment variable, if it exists. If it does not exist an error is returned.

```go
type EnvVar string
```

<a name="EnvVar.UnmarshalText"></a>
### func \(\*EnvVar\) [UnmarshalText](<https://github.com/barbell-math/smoothbrain-argparse/blob/main/unmarshalers.go#L36>)

```go
func (e *EnvVar) UnmarshalText(data []byte) error
```

Checks that the supplied data is a valid path to a file and if so sets the underlying value to the path.

<a name="File"></a>
## type [File](<https://github.com/barbell-math/smoothbrain-argparse/blob/main/unmarshalers.go#L13>)

Can be used to represent a path to a file in a config

```go
type File string
```

<a name="File.UnmarshalText"></a>
### func \(\*File\) [UnmarshalText](<https://github.com/barbell-math/smoothbrain-argparse/blob/main/unmarshalers.go#L83>)

```go
func (f *File) UnmarshalText(data []byte) error
```

Checks that the supplied data is a valid environment variable and if so sets the underlying value to the value of the environment variable.

<a name="ParserOpts"></a>
## type [ParserOpts](<https://github.com/barbell-math/smoothbrain-argparse/blob/main/argparse.go#L18-L41>)



```go
type ParserOpts[T any] struct {
    // The program name that should be printed out on the help menu in the
    // following format: `Usage of <program name>`. If left empty
    // <program name> will be replaced with `this program`.
    ProgName string
    // All arguments provided in this list must be provided. Arguments can
    // be provided in either the CMD line, in a TOML conf file, or both. If
    // an argument is provided in either place it will be marked as present.
    RequiredArgs []string
    // The function that allows the user (you) to define the CMD line
    // arguments. The CMD line argument parameters can be named the same as
    // the keys in the TOML file. Naming the parameters the same as their
    // associated key in the TOML file is generally recommended, and may be
    // necessary to make it so arguments in the [RequiredArgs] list are seen
    // as present from both the CMD line and TOML conf file. Hierarchical
    // keys of the TOML file are separated by a '.'.
    //
    // This function can also be used to set default values. Assuming that
    // you don't have a FlagSet argument for a given value in conf, simply
    // set that value to the default value. If a FlagSet argument
    // corresponds to a value in conf then the default value will be
    // whatever is defined by the FlagSet method.
    ArgDefsSetter func(conf *T, fs *flag.FlagSet) error
}
```

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)


<!-- gomarkdoc:embed:end -->

## Helpful Developer Cmds

To build the build system:

```
go build -o ./bs/bs ./bs
```

The build system can then be used as usual:

```
./bs/bs --help
./bs/bs buildbs # Builds the build system!
```
